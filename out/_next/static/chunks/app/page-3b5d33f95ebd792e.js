(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4118:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>k});var r=t(854),a=t(6422),l=t(5435),n=t(5084),i=t(634),d=t(1891);function o(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,d.QP)((0,i.$)(s))}let c=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function h(e){let{className:s,variant:t,size:a,asChild:n=!1,...i}=e,d=n?l.DX:"button";return(0,r.jsx)(d,{"data-slot":"button",className:o(c({variant:t,size:a,className:s})),...i})}function g(e){let{className:s,...t}=e;return(0,r.jsx)("div",{"data-slot":"card",className:o("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",s),...t})}function u(e){let{className:s,...t}=e;return(0,r.jsx)("div",{"data-slot":"card-header",className:o("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",s),...t})}function x(e){let{className:s,...t}=e;return(0,r.jsx)("div",{"data-slot":"card-title",className:o("leading-none font-semibold",s),...t})}function m(e){let{className:s,...t}=e;return(0,r.jsx)("div",{"data-slot":"card-content",className:o("px-6",s),...t})}let p=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("textarea",{className:o("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...a})});p.displayName="Textarea";var b=t(1541),f=t(8582),v=t(4062),N=t(3131),j=t(5873);class w{get dbSize(){return this.phraseToIDMap.size}removeNonWord(e){let s=e.replace(/\s+/g,"");s=s.replace(/[:：]/g,"COLON");try{s=s.replace(RegExp("\\p{P}|\\p{S}","gu"),"")}catch(e){s=s.replace(/[!"#\$%&'()\*+,\-./:;<=>?@[\\\]^_`{|}~]/g,"")}return(s=s.replace(/[？。，：；、“”‘’（）【】《》「」『』〈〉〖〗…—～＠＃＄％︿＆＊｛｝〔〕·￥]/g,"")).replace(/COLON/g,":")}sentenceSegment(e){let s=[];if(this.dbSize<=0||0===this.longestPhraseLength)return s.push({str:e,id:"none"}),s;if(!e||0===e.length)return s;let t=this.removeNonWord(e).toUpperCase(),r=0,a=0;for(;a<t.length;){let e="",l=0,n="";for(let s=1;s<=this.longestPhraseLength&&!(a+s>t.length);s++){let r=t.substring(a,a+s);this.phraseToIDMap.has(r)&&(e=r,l=s,n=this.phraseToIDMap.get(r))}l>0?(r<a&&s.push({str:t.substring(r,a),id:"none"}),a+=l,r=a,s.push({str:e,id:n})):a++}return r<t.length&&s.push({str:t.substring(r,t.length),id:"none"}),s}getKeyList(){return Array.from(this.phraseToIDMap.keys())}getFileNameFromValue(e){return this.phraseMap.get(e)}constructor(e){if(this.phraseMap=new Map,this.phraseToIDMap=new Map,this.longestPhraseLength=0,!e)return;for(let s of e.split(/\r?\n/)){let e=s.trim().split(/\s+/);if(!e||e.length<=1)continue;let t=e[0];e.length>=2&&this.phraseMap.set(t,e[1]);for(let s=1;s<e.length;s++){if(!e[s]||0===e[s].length)continue;let r=e[s].toUpperCase();this.phraseToIDMap.set(r,t),this.longestPhraseLength<e[s].length&&(this.longestPhraseLength=e[s].length)}}}}let y=(0,j.default)(()=>Promise.all([t.e(59),t.e(685),t.e(790),t.e(633),t.e(722)]).then(t.bind(t,2341)),{loadableGenerated:{webpack:()=>[2341]},ssr:!1});function k(){let[e,s]=(0,a.useState)(""),[t,l]=(0,a.useState)(""),[n,i]=(0,a.useState)(!1),[d,o]=(0,a.useState)([]),[c,j]=(0,a.useState)([]),[k,S]=(0,a.useState)(0),T=async()=>{if(e.trim()){i(!0);try{if(!e||0===e.trim().length)return;let s=await fetch("/assets/word_db_rthk.txt");if(!s.ok)throw Error("Failed to load word DB");let t=await s.text(),r=new w(t).sentenceSegment(e);console.log("segments:",r);let a=[],n=[];for(let e of r)if(e.id&&"none"!==e.id){let s=Number(e.id),t=isNaN(s)?e.id:s.toString().padStart(3,"0");a.push(t),n.push({text:e.str,id:t})}a.push("default"),n.push({text:"。",id:"default"}),o(a),j(n),_(0),l(e)}catch(s){console.error("Translation error:",s),l(e)}finally{i(!1)}}},_=e=>{console.log("Current play index changed to:",e),S(e)};return(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-red-50",children:[(0,r.jsx)("header",{className:"bg-white/80 backdrop-blur-sm border-b border-slate-200 sticky top-0 z-10",children:(0,r.jsx)("div",{className:"max-w-6xl mx-auto px-4 py-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)(N.default,{src:"/images/rthk-logo.png",alt:"RTHK Logo",width:120,height:60,className:"rounded-lg"})}),(0,r.jsxs)("div",{className:"text-center flex-1 ml-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-slate-800 mb-2",children:"Hong Kong Sign Language Translation"}),(0,r.jsx)("p",{className:"text-slate-600",children:"Translate Chinese text to Hong Kong Sign Language"})]})]})})}),(0,r.jsx)("main",{className:"max-w-7xl mx-auto px-4 py-8",children:(0,r.jsxs)("div",{className:"grid lg:grid-cols-5 gap-8 h-full",children:[(0,r.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,r.jsxs)(g,{className:"rounded-2xl border-slate-200 shadow-lg bg-white/90 backdrop-blur-sm",children:[(0,r.jsx)(u,{className:"pb-4",children:(0,r.jsxs)(x,{className:"text-slate-700 flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),"Chinese Text Input"]})}),(0,r.jsxs)(m,{className:"space-y-4",children:[(0,r.jsx)(p,{placeholder:"輸入中文文字...",value:e,onChange:e=>s(e.target.value),className:"min-h-32 rounded-xl border-slate-200 focus:border-red-400 focus:ring-red-400/20 resize-none text-lg"}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)(h,{onClick:T,disabled:!e.trim()||n,className:"flex-1 rounded-xl bg-red-600 hover:bg-red-700 text-white font-medium py-3",children:n?(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Translating..."]}):(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(b.A,{className:"w-4 h-4"}),"Translate"]})}),(0,r.jsx)(h,{onClick:()=>{s(""),l("")},variant:"outline",className:"rounded-xl border-slate-300 hover:bg-slate-50 bg-transparent",children:(0,r.jsx)(f.A,{className:"w-4 h-4"})})]})]})]}),(0,r.jsxs)(g,{className:"rounded-2xl border-slate-200 shadow-lg bg-white/90 backdrop-blur-sm",children:[(0,r.jsx)(u,{className:"pb-4",children:(0,r.jsxs)(x,{className:"text-slate-700 flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-3 h-3 bg-red-400 rounded-full"}),"Hong Kong Sign Language",(0,r.jsxs)("span",{className:"ml-auto text-sm text-gray-500",children:["(",k+1,"/",c.length,")"]})]})}),(0,r.jsx)(m,{children:(0,r.jsx)("div",{className:"p-4 bg-slate-50 rounded-xl border border-slate-200 min-h-24",children:t?(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("div",{className:"text-slate-700 text-lg leading-relaxed",children:c.map((e,s)=>(0,r.jsx)("span",{className:"inline-block px-2 py-1 mx-1 rounded transition-colors duration-300 ".concat(s===k?s===c.length-1?"bg-green-100 text-green-800":"bg-yellow-300 text-black font-semibold":s<k?"bg-green-100 text-green-800":"bg-gray-100 text-gray-700"),children:e.text},s))}),(0,r.jsxs)(h,{variant:"outline",size:"sm",className:"rounded-lg border-slate-300 hover:bg-slate-100 bg-transparent",children:[(0,r.jsx)(v.A,{className:"w-4 h-4 mr-2"}),"Play Audio"]})]}):(0,r.jsx)("p",{className:"text-slate-500 italic",children:"Translation will appear here..."})})})]})]}),(0,r.jsx)("div",{className:"lg:col-span-3",children:(0,r.jsxs)(g,{className:"rounded-2xl border-slate-200 shadow-lg bg-white/90 backdrop-blur-sm sticky top-24 h-full",children:[(0,r.jsx)(u,{className:"pb-4",children:(0,r.jsxs)(x,{className:"text-slate-700 flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-3 h-3 bg-red-400 rounded-full"}),"Sign Language Video"]})}),(0,r.jsx)(m,{className:"pb-6",children:(0,r.jsx)("div",{className:"aspect-video bg-gradient-to-br from-slate-100 to-slate-200 rounded-2xl border-2 border-dashed border-slate-300 flex items-center justify-center overflow-hidden",children:null!=t?(0,r.jsx)("div",{className:"w-full h-full",children:(0,r.jsx)(y,{ids:d,onPlayIndexChange:_})}):(0,r.jsxs)("div",{className:"text-center space-y-4",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-slate-400 rounded-full flex items-center justify-center mx-auto",children:(0,r.jsx)(b.A,{className:"w-8 h-8 text-white ml-1"})}),(0,r.jsx)("p",{className:"text-slate-500 font-medium",children:"Video will appear after translation"})]})})})]})})]})})]})}},9162:(e,s,t)=>{Promise.resolve().then(t.bind(t,4118))}},e=>{var s=s=>e(e.s=s);e.O(0,[920,230,569,358],()=>s(9162)),_N_E=e.O()}]);